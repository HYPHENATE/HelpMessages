jobs:
  install_authenticate:
    executor: sfdx/default
    steps:
      - checkout
      - sfdx/install
      - sfdx/auth:
          defaultusername: daniel@hyphen8.com
      - run:
          command: >
            echo You now have access to the sfdx cli and may execute commands
            against it.

            sfdx force:auth:list
          name: 
            force:org:create -v DevHub -s -f "config/$SCRATCH_DEF" -a scratch
            force:source:push -u scratch
            force:apex:test:run -u scratch -c -r human -d ~/tests/apex -w 9999
orbs:
  sfdx: circleci/salesforce-sfdx@1.0.0
version: 2.1
workflows:
  basic-test:
    jobs:
      - install_authenticate